<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Victor Chernozhukov, Ivan Fernandez-Val, Blaise Melly and Kaspar Wüthrich" />

<meta name="date" content="2019-03-06" />

<title>Inference on quantile and quantile effects for discrete outcomes: the discreteQ package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Inference on quantile and quantile effects for discrete outcomes: the discreteQ package</h1>
<h4 class="author"><em>Victor Chernozhukov, Ivan Fernandez-Val, Blaise Melly and Kaspar Wüthrich</em></h4>
<h4 class="date"><em>2019-03-06</em></h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The discreteQ package contains generic functions that allows researchers to easily apply the methods suggested in the paper “Generic Inference on Quantile and Quantile Effect Functions for Discrete Outcomes” written by <span class="citation">Chernozhukov et al. (2019)</span>. This paper is available at <a href="https://arxiv.org/abs/1608.05142" class="uri">https://arxiv.org/abs/1608.05142</a>. The goal of discreteQ is to perform inference on quantile functions, quantile treatment effect functions and decompositions of differences between quantile functions for possibly discrete outcomes.</p>
</div>
<div id="simple-examples-with-simulated-data" class="section level1">
<h1>Simple examples with simulated data</h1>
<div id="example-1-confidence-bands-for-single-quantile-functions" class="section level2">
<h2>Example 1: confidence bands for single quantile functions</h2>
<p><code>discreteQ()</code> can be used in three different ways. First, the command can provide uniform bands for the unconditional quantile function of an outcome variable. Let’s consider an artificial example with 100 observations drawn from the Poisson distribution with mean 3:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(discreteQ)
<span class="kw">set.seed</span>(<span class="dv">1234</span>)
outcome &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">100</span>, <span class="dv">3</span>)
results1 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome)</code></pre></div>
<p>The output of the function is a list of step functions (the range of quantiles considered, the values at which the distribution function has been estimated and the type of model are also reported at then end):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results1
<span class="co">#&gt; $Q</span>
<span class="co">#&gt; Step function</span>
<span class="co">#&gt; Call: stats::stepfun(F, c(ys, max(ys)), right = TRUE)</span>
<span class="co">#&gt;  x[1:8] =   0.07,   0.25,   0.51,  ...,   0.99,      1</span>
<span class="co">#&gt; 9 plateau levels =      0,      0,      1,  ...,      6,      8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ub.Q</span>
<span class="co">#&gt; Step function</span>
<span class="co">#&gt; Call: stats::stepfun(lb.F.i, c(ys, max(ys)), right = FALSE)</span>
<span class="co">#&gt;  x[1:8] =      0, 0.12995, 0.36257,  ..., 0.97288,      1</span>
<span class="co">#&gt; 9 plateau levels =      0,      1,      2,  ...,      8,      8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lb.Q</span>
<span class="co">#&gt; Step function</span>
<span class="co">#&gt; Call: stats::stepfun(ub.F.i, c(ys, max(ys)), right = TRUE)</span>
<span class="co">#&gt;  x[1:8] = 0.14082, 0.37005, 0.65743,  ...,      1,      1</span>
<span class="co">#&gt; 9 plateau levels =      0,      0,      1,  ...,      6,      8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $F</span>
<span class="co">#&gt; Step function</span>
<span class="co">#&gt; Call: stats::stepfun(ys, c(0, F))</span>
<span class="co">#&gt;  x[1:8] =      0,      1,      2,  ...,      6,      8</span>
<span class="co">#&gt; 9 plateau levels =      0,   0.07,   0.25,  ...,   0.99,      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $lb.F</span>
<span class="co">#&gt; Step function</span>
<span class="co">#&gt; Call: stats::stepfun(ys, c(0, lb.F.i))</span>
<span class="co">#&gt;  x[1:8] =      0,      1,      2,  ...,      6,      8</span>
<span class="co">#&gt; 9 plateau levels =      0,      0, 0.12995,  ..., 0.97288,      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ub.F</span>
<span class="co">#&gt; Step function</span>
<span class="co">#&gt; Call: stats::stepfun(ys, c(0, ub.F.i))</span>
<span class="co">#&gt;  x[1:8] =      0,      1,      2,  ...,      6,      8</span>
<span class="co">#&gt; 9 plateau levels =      0, 0.14082, 0.37005,  ...,      1,      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $q.range</span>
<span class="co">#&gt; [1] 0.05 0.95</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ys</span>
<span class="co">#&gt; [1] 0 1 2 3 4 5 6 8</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $bsrep</span>
<span class="co">#&gt; [1] 200</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $model</span>
<span class="co">#&gt; [1] &quot;univariate&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $method</span>
<span class="co">#&gt; [1] &quot;empirical&quot;</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; attr(,&quot;class&quot;)</span>
<span class="co">#&gt; [1] &quot;discreteQ&quot;</span></code></pre></div>
<p>We recommend using the plot function to display the results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(results1)</code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
<p>The point estimates are shown in dark blue and the uniform bands in light blue. Note that, by default, <code>discreteQ</code> imposes support restrictions such that the confidence bands include only integer values in this example. See the advanced examples below for more details. It is also possible to obtain a tabular summary of the results using summary:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(results1)
<span class="co">#&gt;       quantile QF lower bound upper bound</span>
<span class="co">#&gt;  [1,]     0.05  0           0           1</span>
<span class="co">#&gt;  [2,]     0.10  1           0           1</span>
<span class="co">#&gt;  [3,]     0.15  1           1           2</span>
<span class="co">#&gt;  [4,]     0.20  1           1           2</span>
<span class="co">#&gt;  [5,]     0.25  1           1           2</span>
<span class="co">#&gt;  [6,]     0.30  2           1           2</span>
<span class="co">#&gt;  [7,]     0.35  2           1           2</span>
<span class="co">#&gt;  [8,]     0.40  2           2           3</span>
<span class="co">#&gt;  [9,]     0.45  2           2           3</span>
<span class="co">#&gt; [10,]     0.50  2           2           3</span>
<span class="co">#&gt; [11,]     0.55  3           2           3</span>
<span class="co">#&gt; [12,]     0.60  3           2           3</span>
<span class="co">#&gt; [13,]     0.65  3           2           4</span>
<span class="co">#&gt; [14,]     0.70  3           3           4</span>
<span class="co">#&gt; [15,]     0.75  4           3           4</span>
<span class="co">#&gt; [16,]     0.80  4           3           5</span>
<span class="co">#&gt; [17,]     0.85  4           3           5</span>
<span class="co">#&gt; [18,]     0.90  5           4           5</span>
<span class="co">#&gt; [19,]     0.95  5           4           6</span></code></pre></div>
<p>By default the increment between quantile indexes is 0.05 but this can be modified.</p>
</div>
<div id="example-2-confidence-bands-for-quantile-treatment-effect-functions" class="section level2">
<h2>Example 2: confidence bands for quantile treatment effect functions</h2>
<p>If a treatment variable is provided in the argument d but the argument decomposition is set to FALSE, then <code>discreteQ()</code> provides uniform bands that cover jointly the quantile functions of the treated and control outcomes and the quantile treatment effect functions.</p>
<p>If regressors are provided in the argument x, then the conditional distribution function of the outcome given the covariates is estimated separately in the control and treated group using distribution regression. In a second step, <code>discreteQ()</code> estimates the counterfactual distributions that we would observe if all observations were not treated or treated by integrating the estimated conditional distributions over the distribution of the regressors in the whole sample. The estimated quantile treatment effect function has a causal interpretation if the treatment is randomized conditionally on the control variable (or can be treated as if it were).</p>
<p>Let’s consider a second artificial example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
treatment &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>))
reg &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">2000</span>, <span class="dv">1</span>, <span class="fl">0.4</span><span class="op">+</span>treatment<span class="op">*</span><span class="fl">0.2</span>)
outcome &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">2000</span>, <span class="dt">lambda =</span> <span class="dv">2</span><span class="op">+</span><span class="dv">4</span><span class="op">*</span>reg)</code></pre></div>
<p>We have generated 1000 control observations and 1000 treated observations. The binary regressor reg has a higher mean in treated group, which implies that the outcome has also a higher mean in the treated group. In fact, we see that the unconditional distribution of the outcome in the treated group is stochastically dominated by the unconditional distribution of the outcome in the control group:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results2 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, treatment)
<span class="kw">plot</span>(results2, <span class="dt">main=</span><span class="st">&quot;Difference between the unconditional quantile functions&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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/eA7AcMe9A941TczDKef+v7Y9fHva8b97v3Z9I7Y941z8GE3X7GdxjvsrXQ8a26l3gE/33YfQpcv1proermHgBdtekcIeLNh+i7uqVlzK/U/C73ihViNz71bONCefzHL6tG+qHSv1Rf7sZdbeE/DbHpHCHizYfou7kr9t6E11+vebtbcSgd5HtgeuIfNb94jjXvwAXYb77C30vGsuZUO80KO4fRz7zwG3tjmt+6Rxj34ALuNd9hb6XjW3Ep93o1UHgFffGrsZl9be5ztLDTswdYBT04wD70SC45v24AfLyZfLjosvJADjm3LgGdfyzA+RvZ+YDi2LQOePUE0vPyjQ2g4tr4B7/puBgHDHvQ9hPZmBjgBvU9iPX356U3GBbr1fxppt68oFDDsQd8Xcux0CnqbcYFuPhMLggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYggkYgh0k4OfbYubD551nB3Q4zB745b6j236zA5Y70CH0y/3VPmb33WtbLQZsZdetbMkG25rZ0t+vtmbEQz0Gfizu9jA7AfOmBLxuLjMbTS5g3pSA9zs7AfOmBNz0cn+z4+wEzJsScNPuAQMrCRiCCRiCCRiCnfZZaGAlAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMwAUMw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" width="100%" /> We see that the quantile differences are uniformly weakly positive. In addition, the uniform bands exclude 0 at many quantile indexes. Since these are uniform bands that cover the whole functions with probability 1-alpha (which is 0.95 by default), we can reject the null hypothesis that treated and control unconditional distribution are identical.</p>
<p>However, conditional on the regressors, there are no difference between the control and treated outcomes. The difference between the unconditional quantile functions should, therefore, not be interpreted as a causal effect of the treatment. This is why we now estimate the quantile treatment effect by including the regressors in the estimation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results3 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, treatment, <span class="kw">cbind</span>(<span class="dv">1</span>, reg))
<span class="kw">plot</span>(results3)</code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> The bands now include 0 at all quantile indexes such that we can no longer reject the null hypothesis that the treatment has no effect at all.</p>
<p>The plot function can also be used to visualize the estimated counterfactual distributions that we would observed if nobody was treated (Q0) and that we would observe if everybody was treated (Q1). With the argument add=TRUE it is possible to add the results for the function Q1. With the argument shift it is possible to shift the bands to avoid that they overlap.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(results3, <span class="dt">which=</span><span class="st">&quot;Q0&quot;</span>)
<span class="kw">plot</span>(results3, <span class="dt">which=</span><span class="st">&quot;Q1&quot;</span>, <span class="dt">add=</span><span class="ot">TRUE</span>, <span class="dt">shift=</span><span class="fl">0.2</span>, <span class="dt">col.l=</span><span class="st">&quot;dark green&quot;</span>, <span class="dt">col.b=</span><span class="st">&quot;light green&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="example-3-confidence-bands-for-decompositions-of-observed-differences" class="section level2">
<h2>Example 3: confidence bands for decompositions of observed differences</h2>
<p>Finally, <code>discreteQ()</code> can be used to decompose the difference between the observed quantile function of the outcome for the treated group and the observed quantile function of the outcome for the control group. In order to perform this decomposition <code>discreteQ()</code> estimates the counterfactual distribution that would prevail for control observations had they had the distribution of regressors of treated observations. In other words, we integrate the conditional distribution of the control outcome given the regressors over the unconditional distribution of the regressors for the treated observations. Distribution regression is used to estimated the conditional distribution and the link function can be specified with the argument method.</p>
<p>We can illustrate this third type of applications with the same data. We simply add the argument decomposition=TRUE when we call <code>discreteQ()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">results4 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, treatment, <span class="kw">cbind</span>(<span class="dv">1</span>, reg), <span class="dt">decomposition=</span><span class="ot">TRUE</span>)
<span class="co">#&gt; [1]        407  138549605 -519769706 1084763616 -378399625 -606941198</span>
<span class="co">#&gt; [7]  832006851</span>
<span class="kw">plot</span>(results4)</code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /> By default, plot show all quantile functions in the first panel and the three elements of the decomposition in the remaining panels. Note that the uniform bands cover simultaneously all the functions that appear in the four panels.</p>
<p>In the top-left panel we see both observed unconditional quantile functions as well as the counterfactual quantile function. The top-right panel provides the results for the difference between the observed unconditional distribution (Q1 minus Q0). This difference is decomposed into two components that appear in the bottom panels.</p>
<p>The bottom-left panel provides the difference between the treated and the counterfactual quantile functions (Q1 minus Qc). These two quantile functions are obtain by integrating the same conditional distribution of the outcome over different distribution of the covariates (for Qc we use the distribution of the regressors in the control group and for Q1 we use the distribution of the covariates for the treated group). This difference is known under a variety of names in the literature: the composition effect, the explained component, the justified component, the effect of characteristics.</p>
<p>The bottom-right panel provides the results for the difference between the counterfactual and the control quantile functions (Qc minus Q0). These two quantile functions are obtained by integrating different conditional distribution function over the same distribution of the regressors. Thus, this part of the difference cannot be explained by the different characteristics of the groups. It is therefore called the unexplained difference. In discrimination studies, this component is often interpreted as the discrimination between the group (because it cannot be explained but this interpretation may be incorrect if important regressors are omitted or not observable). If we can assume that the treatment is as good as conditionally randomized, then this component has a causal interpretation as the quantile treatment effect on the treated. Thus, in this case, <code>discreteQ()</code> can be used to estimate the quantile treatment effects for the whole population with the argument decomposition = FALSE and it can be used to estimate the quantile treatment effects on the treated with the argument decomposition = TRUE.</p>
</div>
</div>
<div id="advanced-examples" class="section level1">
<h1>Advanced examples</h1>
<div id="continuous-outcomes-and-support-restrictions" class="section level2">
<h2>Continuous outcomes and support restrictions</h2>
<p>The methods implemented by the package <code>discreteQ</code> can be used with discrete, continuous and mixed continuous-discrete outcomes.<a href="#fn1" class="footnoteRef" id="fnref1"><sup>1</sup></a> The usage of the functions is similar with different types of outcomes but the following two differences are worth noting.</p>
<p>First, since the estimated distribution function of the outcome jumps at all observed values of the outcome in the sample, we should in principle estimate separately the distribution function at all these thresholds. In the presence of covariates, however, estimating a large number of distribution regressions is very time consuming. For this reason, by default, <code>discreteQ()</code> will not estimate a separate distribution regression for each observed value of the outcome but will approximate the conditional distribution using a grid of 100 values. This default behavior can be modified with the argument <code>ys</code>. For instance, setting <code>ys = Inf</code> ensures that the distribution function will be estimated at all observed values.</p>
<p>Second, as shown in <span class="citation">Chernozhukov et al. (2019)</span>, when the outcome is discrete we can make the QF-bands and QE-bands more informative by imposing support restrictions. By default, the function <code>plot.discreteQ()</code> assumes that the support of the outcome is discrete when the empirical support contains less than 200 different values. In this case, the true support is estimated by the empirical support of the outcome. For continuous outcomes, the user should override this default behavior by setting <code>support = &quot;continuous&quot;</code> when calling the <code>plot</code> function for <code>discreteQ</code> objects.</p>
<p>We know illustrate the use of the <code>discreteQ</code> functions with a continuous outcome:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
outcome &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">500</span>, <span class="dv">3</span>)
results5 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, <span class="dt">ys =</span> <span class="ot">Inf</span>)
<span class="kw">plot</span>(results5, <span class="dt">support =</span> <span class="st">&quot;continuous&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" width="100%" /></p>
</div>
<div id="estimation-of-conditional-distribution-functions-in-the-presence-of-covariates" class="section level2">
<h2>Estimation of conditional distribution functions in the presence of covariates</h2>
<p>In the presence of covariates, the conditional distribution function of the outcome given the covariates must be estimated. The main estimation method implemented by <code>discreteQ</code> is distribution regression. This method consists in estimating a different binary regression for each threshold <span class="math inline">\(y\)</span>. The binary variable <span class="math inline">\(1(y_i\leq y)\)</span> is regressed on the regressors <code>x</code>. This yields the distribution regression model with <span class="math display">\[F_{Y\mid X}\left( y\mid x\right) =P(Y\leq y\mid X=x)=\Lambda _{y}\left(x^{\prime }\beta \left( y\right) \right)\]</span> where <span class="math inline">\(\Lambda _{y}(\cdot )\)</span> is a known link function which is allowed to change with the threshold level <span class="math inline">\(y\)</span> and <span class="math inline">\(\beta \left( y\right)\)</span> is an unknown vector of parameters.</p>
<p>By default, <code>discreteQ()</code> uses the logistic link function <span class="math inline">\(\Lambda\left(x'\beta\left(y\right)\right)=\frac{1}{1+e^{-x'\beta(y)}}\)</span>. Alternatively, the Gaussian link function is used if <code>method = &quot;probit&quot;</code>, the complementary log-log link function (which nests as a special case the Cox proportional hazard model) if <code>method = &quot;cloglog&quot;</code>, the Cauchy link function if <code>method = &quot;cauchit&quot;</code>, the Poisson link function suggested by <span class="citation">Chernozhukov et al. (2019)</span> (which nests as a special case the Poisson regression model) if <code>method = &quot;drp&quot;</code>, the identity link function (which consists in estimating an OLS regression for each threshold, also called the linear probability model) if <code>method = &quot;lpm&quot;</code>.</p>
<p>The fully parametric Poisson regression model is also implemented by <code>discreteQ()</code> when <code>method = &quot;poisson&quot;</code>. The difference between the Poisson regression model and the distribution regression models discussed above is that the Poisson regression model imposes the same index <span class="math inline">\(x'\beta\)</span> at all thresholds. This is a strong homogeneity assumption which may be rejected by the data even when there are no covariates or a fully saturated set of covariates. On the other hand, the distribution regression model allows for a different vector of coefficients <span class="math inline">\(\beta(y)\)</span> at each threshold. This model does not impose any parametric assumption on the data when we have a fully saturated set of covariates. The distribution regression with the Poisson link function (implemented when <code>method = &quot;drp&quot;</code>) strictly nests the Poisson regression model (implemented when <code>method = &quot;poisson&quot;</code>). If these two methods give statistically different results then we must conclude that the Poisson regression model is rejected by the data.</p>
</div>
<div id="weighted-cluster-bootstrap" class="section level2">
<h2>Weighted cluster bootstrap</h2>
<p>By default, the function <code>discreteQ()</code> assumes that the sample has been randomly drawn from the population of interest. In this case, the (Bayesian) weighted bootstrap is used to estimate the uniform bands for the distribution functions: For each observation and each replication the function randomly draw a weight from the standard exponential distribution. For each replication, the distribution function is estimated using the original but weighted sample. An advantage of this method (compared with the nonparametric bootstrap) is that no bootstrap sample will suffer from multicollinearity if the original sample does not suffer from multicollinearity.</p>
<p>Cluster sampling gives rise to correlation between units within the same cluster. For example, the number of doctor visits of individuals within a household may be correlated because of common (often unobserved) characteristics of individuals within a household or because of features of the household itself (such as type of retirement plan). When this is the case, the user must provide a vector that identifies the clusters to the argument <code>cluster</code>. When this is the case, the weighted cluster bootstrap is used. The weights are still draw from the standard exponential distribution but all the units in the same cluster receive the same weight. This procedure allows for abitrary correlation within the clusters but assume random sampling of the clusters. The number of clusters must be large.</p>
</div>
<div id="parallel-computing" class="section level2">
<h2>Parallel computing</h2>
<p>The computing time may be long if the numbers of observations, regressors, points in the support of the dependent variable, and bootstrap replications are large. For this reason, parallel processing has been implemented by <code>discreteQ()</code>. The user must first create a cluster object with the desired number of parallel processes. This object is then pass to <code>discreteQ()</code>via the argument <code>cl</code>. Here is a comparison of the computing time for a simple example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1234</span>)
treatment &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">1000</span>), <span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">1000</span>))
reg &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">2000</span>, <span class="dv">1</span>, <span class="fl">0.4</span><span class="op">+</span>treatment<span class="op">*</span><span class="fl">0.2</span>)
outcome &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">2000</span>, <span class="dt">lambda =</span> <span class="dv">2</span><span class="op">+</span><span class="dv">4</span><span class="op">*</span>reg)
<span class="co">#Without parallel computing</span>
<span class="kw">set.seed</span>(<span class="dv">42</span>)
<span class="kw">system.time</span>(results6 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, treatment, reg))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;   28.88    0.00   29.63</span>
my_cl &lt;-<span class="st"> </span>parallel<span class="op">::</span><span class="kw">makePSOCKcluster</span>(<span class="dv">2</span>)
<span class="co">#With parallel computing</span>
<span class="kw">set.seed</span>(<span class="dv">42</span>)
<span class="kw">system.time</span>(results7 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, treatment, reg, <span class="dt">cl =</span> my_cl ))
<span class="co">#&gt;    user  system elapsed </span>
<span class="co">#&gt;    0.18    0.00   15.06</span></code></pre></div>
<p>The results are replicable simply by setting the seed with <code>set.seed()</code>. If this is done, exactly the same results will be obtained with or without parallel computing. In both cases, a sequence of random streams (a seed for each bootstrap replication) is generated with <code>rngtools:RNGseq</code>. This sequence is returne by <code>discreteQ()</code> if <code>return.seeds = TRUE</code>. Such a sequence can be passed to the argument <code>list_of_seeds</code> of <code>discreteQ()</code>, which permits replicating particular bootstrap draws.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Results with and without parallel computing are equal</span>
<span class="kw">all.equal</span>(results6, results7)
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div id="changing-the-confidence-level-or-the-quantile-range" class="section level2">
<h2>Changing the confidence level or the quantile range</h2>
<p>The confidence bands estimated by <code>discreteQ()</code> cover the true functions in the range of quantiles determined by the argument <code>q.range</code> with the coverage rate equal to 1 minus the confidence level <code>alpha</code>. If the user wants to obtain the bands for different quantile ranges or different confidence levels, she can save the bootstrap results by setting the argument <code>return.boot = TRUE</code> and then provide these bootstrap results to the argument <code>old.res</code>. This avoids computing the results each time when the only difference is the level or the quantile range. Here is an example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#95% confidence bands (default value)</span>
results8 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, treatment, reg, <span class="dt">return.boot =</span> <span class="ot">TRUE</span>)
<span class="co">#90% confidence bands</span>
results9 &lt;-<span class="st"> </span><span class="kw">discreteQ</span>(outcome, treatment, reg, <span class="dt">old.res =</span> results8, <span class="dt">alpha =</span> <span class="fl">0.1</span>)</code></pre></div>
</div>
</div>
<div id="concluding-remarks" class="section level1">
<h1>Concluding remarks</h1>
<p>For the precise definition of the estimators and their statistical properties, you are invited to read the paper “Generic Inference on Quantile and Quantile Effect Functions for Discrete Outcomes” written by Victor Chernozhukov, Ivan Fernandez-Val, Blaise Melly, and Kaspar Wüthrich. This paper is available at <a href="https://arxiv.org/abs/1608.05142" class="uri">https://arxiv.org/abs/1608.05142</a>.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-chen2017counterfactual">
<p>Chen, Mingli, Victor Chernozhukov, Iván Fernández-Val, and Blaise Melly. 2017. “Counterfactual: An R Package for Counterfactual Analysis.” <em>The R Journal</em> 9 (1): 370–84. doi:<a href="https://doi.org/10.32614/RJ-2017-033">10.32614/RJ-2017-033</a>.</p>
</div>
<div id="ref-chernozhukov2016generic">
<p>Chernozhukov, Victor, Ivan Fernandez-Val, Blaise Melly, and Kaspar Wüthrich. 2019. “Generic Inference on Quantile and Quantile Effect Functions for Discrete Outcomes.” <em>arXiv Preprint arXiv:1608.05142</em>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>For continuous outcomes we nevertheless recommend using the package <code>Counterfactual</code>, which is available from CRAN <span class="citation">(Chen et al. 2017)</span>. Its functions offers additional options and sharper inference for quantile effects when the outcome is continuous.<a href="#fnref1">↩</a></p></li>
</ol>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
